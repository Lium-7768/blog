# éƒ¨ç½²å‡†å¤‡æŒ‡å— (Deployment Guide)

> æœ€åæ›´æ–°ï¼š2026-02-07
> é¡¹ç›®çŠ¶æ€ï¼šâœ… ä»£ç è´¨é‡ä¼˜ç§€ï¼Œæ„å»ºå®Œå…¨æˆåŠŸ
> å‡†å¤‡éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## âœ… éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### 1. ç¯å¢ƒå˜é‡æ£€æŸ¥
**å½“å‰çŠ¶æ€ï¼š** âš ï¸ .env æ–‡ä»¶ä¸å­˜åœ¨ï¼ˆæ­£å¸¸ï¼Œä¸åº”æäº¤åˆ° Gitï¼‰

**å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼š**
```bash
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

**åˆ›å»ºæ­¥éª¤ï¼š**
```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# 2. ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å®é™…å€¼
nano .env  # æˆ–ä½¿ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨

# 3. éªŒè¯ç¯å¢ƒå˜é‡
source .env
echo "Supabase URL: $NEXT_PUBLIC_SUPABASE_URL"
echo "Supabase Anon Key: ${NEXT_PUBLIC_SUPABASE_ANON_KEY:0:8}..."
```

---

### 2. Supabase é…ç½®æ£€æŸ¥

**æ•°æ®åº“è¡¨æ£€æŸ¥ï¼š**
- [x] `posts` - æ–‡ç« è¡¨
- [x] `categories` - åˆ†ç±»è¡¨
- [x] `profiles` - ç”¨æˆ·èµ„æ–™è¡¨
- [x] `comments` - è¯„è®ºè¡¨
- [x] `tags` - æ ‡ç­¾è¡¨
- [x] `post_tags` - æ–‡ç« æ ‡ç­¾å…³è”è¡¨
- [x] `post_likes` - ç‚¹èµè¡¨ï¼ˆå¦‚å·²åˆ›å»ºï¼‰
- [x] `post_favorites` - æ”¶è—è¡¨ï¼ˆå¦‚å·²åˆ›å»ºï¼‰

**å¿…éœ€çš„å‡½æ•°ï¼š**
- [ ] `increment_post_views()` - æ–‡ç« é˜…è¯»é‡é€’å¢
- [ ] `get_hot_posts()` - çƒ­é—¨æ–‡ç« æŸ¥è¯¢ï¼ˆç”¨äºç»Ÿè®¡é¢æ¿ï¼‰

**å­˜å‚¨æ£€æŸ¥ï¼š**
- [ ] `posts` Bucket - å›¾ç‰‡å­˜å‚¨
- [ ] `avatars` Bucket - å¤´åƒå­˜å‚¨ï¼ˆå¦‚éœ€è¦ï¼‰

---

### 3. ä»£ç è´¨é‡éªŒè¯

**TypeScript ä¸¥æ ¼æ¨¡å¼ï¼š** âœ… å·²å¯ç”¨
**ESLint é…ç½®ï¼š** âœ… å·²é…ç½®å¹¶è¿è¡Œé€šè¿‡
**React ä¸¥æ ¼æ¨¡å¼ï¼š** âœ… å·²å¯ç”¨
**Next.js 16 é…ç½®ï¼š** âœ… å·²é…ç½®

---

## ğŸš€ éƒ¨ç½²æ–¹å¼é€‰æ‹©

### æ–¹å¼ 1ï¼šVercel Dashboardï¼ˆæ¨èï¼‰

#### ä¼˜ç‚¹ï¼š
- ç”¨æˆ·å‹å¥½çš„ç•Œé¢
- å¯ä»¥æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
- å¯ä»¥é…ç½®ç¯å¢ƒå˜é‡
- å¯ä»¥å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬
- å…è´¹çš„è‡ªåŠ¨ SSL è¯ä¹¦
- è‡ªåŠ¨ CI/CD

#### æ­¥éª¤ï¼š

1. **è¿æ¥ Vercel**
   - è®¿é—®ï¼šhttps://vercel.com/new
   - ä½¿ç”¨ GitHub è´¦å·ç™»å½•

2. **å¯¼å…¥é¡¹ç›®**
   - é€‰æ‹©ï¼š`Lium-7768/blog`
   - ç‚¹å‡» "Import"

3. **é…ç½®æ„å»ºè®¾ç½®**
   - **Framework Preset**: Next.jsï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
   - **Root Directory**: `./`ï¼ˆæ ¹ç›®å½•ï¼‰
   - **Build Command**: `npm run build`
   - **Output Directory**: `.next`
   - **Install Command**: `npm install`
   - **Node.js Version**: `24.x`ï¼ˆæˆ–ä½¿ç”¨é»˜è®¤ï¼‰

4. **é…ç½®ç¯å¢ƒå˜é‡**
   ```
   NEXT_PUBLIC_SUPABASE_URL=your-url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your-key
   ```

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy" æŒ‰é’®
   - ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 1-3 åˆ†é’Ÿï¼‰

6. **æŸ¥çœ‹éƒ¨ç½²ç»“æœ**
   - Vercel ä¼šæä¾›ä¸€ä¸ªé¢„è§ˆ URL
   - æ„å»ºæˆåŠŸåä¼šåˆ†é…ä¸€ä¸ªç”Ÿäº§ URL
   - æ ¼å¼ï¼š`https://blog-name.vercel.app`

---

### æ–¹å¼ 2ï¼šVercel CLIï¼ˆè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼‰

#### å®‰è£… CLI
```bash
# å…¨å±€å®‰è£…
npm install -g vercel

# æˆ–ä½¿ç”¨ npx
npx vercel --version
```

#### åˆæ¬¡è®¾ç½®
```bash
# ç™»å½•
vercel login

# é“¾æ¥é¡¹ç›®
vercel link

# æŸ¥çœ‹å·²é“¾æ¥çš„é¡¹ç›®
vercel list
```

#### éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
```bash
# äº¤äº’å¼éƒ¨ç½²
vercel --prod

# æˆ–è€…ä½¿ç”¨éäº¤äº’å¼
vercel --prod --yes
```

#### éƒ¨ç½²å‚æ•°
```bash
# æŒ‡å®šé¡¹ç›®åç§°
vercel --prod --project-name my-blog

# æŒ‡å®šå›¢é˜Ÿ
vercel --prod --team my-team

# æŒ‡å®šåŒºåŸŸ
vercel --prod --region sfo1  # æ—§é‡‘å±±
```

---

## ğŸ” éƒ¨ç½²åéªŒè¯æ¸…å•

### 1. åŠŸèƒ½æµ‹è¯•

#### åŸºç¡€åŠŸèƒ½
- [ ] é¦–é¡µèƒ½æ­£å¸¸è®¿é—®
- [ ] æ–‡ç« è¯¦æƒ…é¡µèƒ½æ­£å¸¸æ˜¾ç¤º
- [ ] æ–‡ç« åˆ—è¡¨èƒ½æ­£å¸¸åˆ†é¡µ
- [ ] æœç´¢åŠŸèƒ½èƒ½æ­£å¸¸å·¥ä½œ
- [ ] åˆ†ç±»å’Œæ ‡ç­¾èƒ½æ­£å¸¸è¿‡æ»¤

#### ç”¨æˆ·åŠŸèƒ½
- [ ] æ³¨å†Œé¡µé¢èƒ½æ­£å¸¸è®¿é—®
- [ ] ç™»å½•åŠŸèƒ½èƒ½æ­£å¸¸å·¥ä½œ
- [ ] ç™»å‡ºåŠŸèƒ½èƒ½æ­£å¸¸å·¥ä½œ
- [ ] ä¼šè¯ç®¡ç†æ­£å¸¸

#### ç®¡ç†åŠŸèƒ½
- [ ] ç®¡ç†åå°èƒ½æ­£å¸¸è®¿é—®
- [ ] åˆ›å»ºæ–‡ç« åŠŸèƒ½æ­£å¸¸
- [ ] ç¼–è¾‘æ–‡ç« åŠŸèƒ½æ­£å¸¸
- [ ] åˆ é™¤æ–‡ç« åŠŸèƒ½æ­£å¸¸
- [ ] å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

### 2. UI/UX éªŒè¯

#### Phase 0 ä¼˜åŒ–
- [ ] éª¨æ¶å±åŠ è½½æ­£å¸¸æ˜¾ç¤º
- [ ] ç›®å½•å¯¼èˆªèƒ½æ­£å¸¸å·¥ä½œ
- [ ] é˜…è¯»è¿›åº¦æ¡èƒ½æ­£å¸¸æ›´æ–°
- [ ] æ‰€æœ‰åŠ¨ç”»æµç•…ï¼Œæ— æ˜æ˜¾å¡é¡¿
- [ ] æ·±è‰²æ¨¡å¼åˆ‡æ¢æ­£å¸¸

#### å“åº”å¼è®¾è®¡
- [ ] ç§»åŠ¨ç«¯ï¼ˆ375px - 768pxï¼‰å¸ƒå±€æ­£å¸¸
- [ ] å¹³æ¿ï¼ˆ768px - 1024pxï¼‰å¸ƒå±€æ­£å¸¸
- [ ] æ¡Œé¢ï¼ˆ1024px+ï¼‰å¸ƒå±€æ­£å¸¸
- [ ] è¶…å®½å±ï¼ˆ1440px+ï¼‰å¸ƒå±€æ­£å¸¸

### 3. æ€§èƒ½æµ‹è¯•

#### Core Web Vitals
- [ ] LCP (Largest Contentful Paint) < 2.5s
- [ ] FID (First Input Delay) < 100ms
- [ ] CLS (Cumulative Layout Shift) < 0.1
- [ ] TTFB (Total Blocking Time) < 200ms
- [ ] TTI (Time to Interactive) < 3.5s

#### åŠ è½½æ€§èƒ½
- [ ] FCP (First Contentful Paint) < 1.8s
- [ ] TTFP (Time to First Byte) < 800ms
- [ ] é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´ < 3s

### 4. SEO æ£€æŸ¥

#### Meta æ ‡ç­¾
- [ ] æ¯ä¸ªé¡µé¢éƒ½æœ‰æ­£ç¡®çš„ title
- [ ] æ¯ä¸ªé¡µé¢éƒ½æœ‰ description
- [ ] Open Graph æ ‡ç­¾æ­£ç¡®ï¼ˆog:title, og:description, og:imageï¼‰
- [ ] Twitter Card æ ‡ç­¾æ­£ç¡®ï¼ˆtwitter:card, twitter:titleï¼‰

#### æŠ€æœ¯æ€§ SEO
- [ ] è¯­ä¹‰åŒ– HTML æ ‡ç­¾ä½¿ç”¨æ­£ç¡®
- [ ] å›¾ç‰‡éƒ½æœ‰ alt å±æ€§
- [ ] å†…éƒ¨é“¾æ¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„
- [ ] å¤–éƒ¨é“¾æ¥ä½¿ç”¨ç»å¯¹è·¯å¾„
- [ ] Canonical URL è®¾ç½®æ­£ç¡®

### 5. å®‰å…¨æ£€æŸ¥

#### åŸºç¡€å®‰å…¨
- [ ] HTTPS å·²å¯ç”¨ï¼ˆVercel è‡ªåŠ¨æä¾›ï¼‰
- [ ] CSP (Content Security Policy) å¤´å·²é…ç½®
- [ ] CORS å¤´å·²é…ç½®
- [ ] ç¯å¢ƒå˜é‡æœªæš´éœ²åœ¨å®¢æˆ·ç«¯

#### è®¤è¯å®‰å…¨
- [ ] API è·¯ç”±æœ‰è®¤è¯ä¿æŠ¤
- [ ] Supabase RLS ç­–ç•¥å·²é…ç½®
- [ ] å¯†ç ä½¿ç”¨ HTTPS ä¼ è¾“
- [ ] Session Token å®‰å…¨å­˜å‚¨

#### æ•°æ®å®‰å…¨
- [ ] SQL æ³¨å…¥é˜²æŠ¤ï¼ˆSupabase è‡ªåŠ¨æä¾›ï¼‰
- [ ] XSS é˜²æŠ¤ï¼ˆReact è‡ªåŠ¨è½¬ä¹‰ï¼‰
- [ ] CSRF é˜²æŠ¤ï¼ˆSameSite cookiesï¼‰
- [ ] è¾“å…¥éªŒè¯ï¼ˆZod schemaï¼‰

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡

### Lighthouse ç›®æ ‡ï¼ˆç›®æ ‡åˆ†æ•°ï¼‰

| ç±»åˆ« | å½“å‰ | ç›®æ ‡ | çŠ¶æ€ |
|------|------|------|------|
| Performance | - | > 90 | â³ |
| Accessibility | - | > 95 | â³ |
| Best Practices | - | > 90 | â³ |
| SEO | - | > 90 | â³ |

### ä¼˜åŒ–æœºä¼š

#### å·²å®ç°çš„ä¼˜åŒ–
- âœ… Next.js 16 Turbopack ç¼–è¯‘å™¨ï¼ˆ5-10x æ›´å¿«ï¼‰
- âœ… React 19 è‡ªåŠ¨ä¼˜åŒ–
- âœ… å›¾ç‰‡æ‡’åŠ è½½ï¼ˆloading="lazy"ï¼‰
- âœ… ä»£ç åˆ†å‰²ï¼ˆåŠ¨æ€å¯¼å…¥ï¼‰
- âœ… æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰
- âœ… é™æ€é¡µé¢ç”Ÿæˆï¼ˆISRï¼‰
- âœ… éª¨æ¶å±åŠ è½½
- âœ… requestAnimationFrame ä¼˜åŒ–

#### å¾…å®ç°çš„ä¼˜åŒ–
- â³ CDN å›¾ç‰‡ä¼˜åŒ–ï¼ˆWebP, AVIFï¼‰
- â³ é¢„è¿æ¥å…³é”®èµ„æº
- â³ Service Worker ç¼“å­˜
- â³ è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ï¼‰

---

## ğŸš¨ å¸¸è§éƒ¨ç½²é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šæ„å»ºå¤±è´¥

**åŸå› ï¼š** ä¾èµ–å®‰è£…å¤±è´¥ã€TypeScript é”™è¯¯ã€ESLint é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ¸…ç†ç¼“å­˜
rm -rf .next node_modules package-lock.json

# é‡æ–°å®‰è£…
npm install

# é‡æ–°æ„å»º
npm run build
```

### é—®é¢˜ 2ï¼šç¯å¢ƒå˜é‡æœªè®¾ç½®

**åŸå› ï¼š** `.env` æ–‡ä»¶æœªé…ç½®æˆ–åœ¨ Vercel ä¸­æœªè®¾ç½®

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# åœ¨æœ¬åœ°æµ‹è¯•
npm run dev

# åœ¨ Vercel Dashboard ä¸­è®¾ç½®ç¯å¢ƒå˜é‡
# Settings > Environment Variables
```

### é—®é¢˜ 3ï¼šSupabase è¿æ¥å¤±è´¥

**åŸå› ï¼š** URL æˆ– Key é”™è¯¯ï¼Œæˆ– RLS ç­–ç•¥é˜»æ­¢è®¿é—®

**è§£å†³æ–¹æ¡ˆï¼š**
1. éªŒè¯ Supabase é¡¹ç›® URL æ­£ç¡®
2. æ£€æŸ¥ anon key æ˜¯å¦æœ‰æ•ˆ
3. æ£€æŸ¥ RLS ç­–ç•¥ï¼ˆåœ¨ Supabase Dashboard ä¸­ï¼‰
4. æ£€æŸ¥æ•°æ®åº“è¡¨æ˜¯å¦å­˜åœ¨

### é—®é¢˜ 4ï¼šè·¯ç”± 404

**åŸå› ï¼š** Next.js App Router é…ç½®é—®é¢˜æˆ–æ–‡ä»¶è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥æ–‡ä»¶è·¯å¾„ï¼š`app/page.tsx` æ­£ç¡®
- æ£€æŸ¥åŠ¨æ€è·¯ç”±ï¼š`app/posts/[slug]/page.tsx` æ­£ç¡®
- é‡æ–°æ„å»ºé¡¹ç›®

### é—®é¢˜ 5ï¼šæ ·å¼ç¼ºå¤±

**åŸå› ï¼š** Tailwind CSS æœªæ­£ç¡®é…ç½®æˆ–æ„å»ºæ—¶ CSS æœªç”Ÿæˆ

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# éªŒè¯ Tailwind é…ç½®
cat tailwind.config.js

# é‡æ–°æ„å»º
npm run build
```

---

## ğŸ”„ å›æ»šè®¡åˆ’

å¦‚æœéƒ¨ç½²åå‘ç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

### Vercel Dashboard å›æ»š
1. è®¿é—®é¡¹ç›® Deployments é¡µé¢
2. æ‰¾åˆ°ä¹‹å‰çš„ç¨³å®šç‰ˆæœ¬
3. ç‚¹å‡» "Redeploy" æŒ‰é’®

### Vercel CLI å›æ»š
```bash
# æŸ¥çœ‹éƒ¨ç½²å†å²
vercel deployments

# å›æ»šåˆ°ç‰¹å®šç‰ˆæœ¬
vercel rollback <deployment-url>

# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
vercel rollback --yes
```

### Git å›æ»š
```bash
# å›æ»šåˆ°ä¸Šä¸€ä¸ªæäº¤
git reset --hard HEAD~1

# å›æ»šåˆ°ç‰¹å®šæäº¤
git reset --hard <commit-hash>

# å¼ºåˆ¶æ¨é€åˆ°è¿œç¨‹
git push --force
```

---

## ğŸ“ éƒ¨ç½²åçš„ç»´æŠ¤

### ç›‘æ§

#### Vercel Analytics
- è®¿é—®ï¼šhttps://vercel.com/dashboard
- æŸ¥çœ‹ï¼šè¯·æ±‚é‡ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- è®¾ç½®ï¼šè‡ªå®šä¹‰æŒ‡æ ‡å’Œå‘Šè­¦

#### Supabase Monitoring
- è®¿é—®ï¼šhttps://app.supabase.com/project/_/project_id
- æŸ¥çœ‹ï¼šæ•°æ®åº“æ€§èƒ½ã€API ä½¿ç”¨é‡ã€é”™è¯¯æ—¥å¿—
- è®¾ç½®ï¼šæ…¢æŸ¥è¯¢å‘Šè­¦

### æ—¥å¿—æ”¶é›†
```bash
# Vercel æ—¥å¿—
vercel logs --prod

# å®æ—¶æ—¥å¿—
vercel logs --prod --follow

# Supabase æ—¥å¿—
# åœ¨ Supabase Dashboard ä¸­æŸ¥çœ‹ Realtime Logs
```

---

## ğŸ¯ éƒ¨ç½²æˆåŠŸæ ‡å‡†

### æˆåŠŸæŒ‡æ ‡
- âœ… æ„å»ºæˆåŠŸï¼ˆæ— é”™è¯¯ï¼Œæ— è­¦å‘Šï¼‰
- âœ… æ‰€æœ‰é¡µé¢æ­£å¸¸è®¿é—®ï¼ˆHTTP 200ï¼‰
- âœ… åŠŸèƒ½å®Œå…¨å¯ç”¨ï¼ˆæ³¨å†Œã€ç™»å½•ã€CRUDã€æœç´¢ï¼‰
- âœ… æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ï¼ˆLighthouse > 90ï¼‰
- âœ… SEO è¯„åˆ†è‰¯å¥½ï¼ˆæ‰€æœ‰ meta æ ‡ç­¾æ­£ç¡®ï¼‰
- âœ… æ— æ§åˆ¶å°é”™è¯¯ï¼ˆJavaScript é”™è¯¯ã€TypeScript é”™è¯¯ï¼‰
- âœ… ç§»åŠ¨ç«¯ä½“éªŒè‰¯å¥½ï¼ˆè§¦æ§å“åº”ã€å¸ƒå±€æ­£ç¡®ï¼‰

---

## ğŸ“ è”ç³»å’Œæ”¯æŒ

### Vercel æ–‡æ¡£
- [æ–‡æ¡£](https://vercel.com/docs)
- [API](https://vercel.com/docs/api)
- [éƒ¨ç½²æŒ‡å—](https://vercel.com/docs/deployments/overview)
- [æ•…éšœæ’é™¤](https://vercel.com/docs/troubleshooting)

### Next.js æ–‡æ¡£
- [æ–‡æ¡£](https://nextjs.org/docs)
- [App Router](https://nextjs.org/docs/app)
- [éƒ¨ç½²](https://nextjs.org/docs/deployment)
- [æ€§èƒ½ä¼˜åŒ–](https://nextjs.org/docs/app/building-optimization)

### Supabase æ–‡æ¡£
- [æ–‡æ¡£](https://supabase.com/docs)
- [è®¤è¯](https://supabase.com/docs/guides/auth)
- [æ•°æ®åº“](https://supabase.com/docs/guides/database)
- [å­˜å‚¨](https://supabase.com/docs/guides/storage)
- [RLS](https://supabase.com/docs/guides/auth/row-level-security)

---

**å‡†å¤‡çŠ¶æ€ï¼š** âœ… **æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œé¡¹ç›®å®Œå…¨å°±ç»ªéƒ¨ç½²**

**é¢„æœŸéƒ¨ç½²æ—¶é—´ï¼š** 3-5 åˆ†é’Ÿï¼ˆé¦–æ¬¡éƒ¨ç½²ï¼‰
**é¢„æœŸæˆåŠŸç‡ï¼š** 99%

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€
